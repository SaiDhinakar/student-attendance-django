<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    {% load static %}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Attendance System - Student Attendance{% endblock %}</title>
    
    <!-- Client's Icon Pack -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/iconoir@latest/css/iconoir.css">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="{% static 'css/tailwind.css' %}">
    
    <!-- Client's Custom Theme -->
    <link rel="stylesheet" href="{% static 'css/custom-theme.css' %}">
    
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    {% block extra_css %}{% endblock %}
  </head>
  <body class="min-h-screen text-primary-custom main-body-bg">

    <!-- HEADER -->
    <header class="fixed top-0 z-50 w-full header-bg shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16 md:h-20">
          
          <!-- Left: Mobile Menu Button + Logo -->
          <div class="flex items-center space-x-3">
            <!-- Mobile menu button -->
            <button
              id="sidebarToggle"
              class="md:hidden inline-flex items-center justify-center p-2 rounded-md nav-link hover:bg-primary hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-accent"
              aria-label="Open menu"
            >
              <i class="iconoir-menu text-xl"></i>
            </button>

            <!-- Logo -->
            <a href="{% if user.groups.all.0.name == 'Advisors' %}{% url 'advisor_dashboard:dashboard' %}{% else %}{% url 'attendance_dashboard:dashboard' %}{% endif %}" class="flex items-center space-x-3">
              <img src="{% static 'img/image.png' %}" alt="Logo" class="h-10 w-10 md:h-12 md:w-12" />
              <div class="hidden sm:block">
                <h1 class="text-lg font-bold text-primary-custom">SSIET</h1>
                <p class="text-xs text-secondary-custom">Attendance</p>
              </div>
            </a>
          </div>

        <!-- Center: College Info -->
        <div class="flex flex-1 items-center justify-center text-center px-4 md:px-8">
          <div>
            <h1 class="text-sm md:text-lg lg:text-xl font-bold text-primary-custom leading-tight">
              SRI SHAKTHI INSTITUTE OF ENGINEERING AND TECHNOLOGY
            </h1>
            <p class="text-xs md:text-sm text-secondary-custom font-medium mt-1">
              <i class="iconoir-check-circle mr-1"></i>
              Attendance Management System
            </p>
          </div>
        </div>

          <!-- Right: User Profile -->
          <div class="flex items-center space-x-3">
            <div class="relative group">
              <button
                id="userMenuButton"
                class="flex items-center space-x-2 nav-link hover:bg-primary hover:text-white rounded-md px-3 py-2 transition-colors"
              >
                <div class="flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full">
                  <i class="iconoir-user text-sm"></i>
                </div>
                <span class="text-sm font-medium hidden sm:block">{{ user.get_full_name|default:user.username }}</span>
                <i class="iconoir-nav-arrow-down text-xs hidden sm:block group-hover:rotate-180 transition-transform"></i>
              </button>

              <!-- Dropdown menu -->
              <div
                id="userMenuDropdown"
                class="absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-surface ring-1 ring-border hidden z-50"
              >
                <div class="py-1">
                  <a href="{% url 'logout' %}" class="block px-4 py-2 text-sm text-primary-custom hover:bg-muted">
                    <i class="iconoir-log-out mr-2"></i>
                    Sign out
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="pt-16 md:pt-20 min-h-screen main-section-bg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% block content %}{% endblock %}
      </div>
    </main>

    <!-- JavaScript -->
    <script>
      // User Menu Dropdown
      const userMenuButton = document.getElementById('userMenuButton');
      const userMenuDropdown = document.getElementById('userMenuDropdown');

      userMenuButton.addEventListener('click', () => {
        userMenuDropdown.classList.toggle('hidden');
      });

      // Close dropdown when clicking outside
      document.addEventListener('click', (event) => {
        if (!userMenuButton.contains(event.target)) {
          userMenuDropdown.classList.add('hidden');
        }
      });
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
